{
  "id": "d0000000-0000-0000-0000-000000000004",
  "kind": "Template",
  "name": "ErrorsTemplate",
  "schema_version": "2.0",
  "spec": {
    "description": "Generate error types from endpoint error definitions",
    "helpers": [
      {
        "function": "to_snake_case",
        "name": "snake_case"
      },
      {
        "function": "to_pascal_case",
        "name": "pascal_case"
      }
    ],
    "input": "Vec<IntentDocument>",
    "output_file": "gen/src/errors.rs",
    "template": [
      "// @generated by intent-engine v{{version}}",
      "// DO NOT EDIT - changes will be overwritten",
      "",
      "use axum::response::IntoResponse;",
      "",
      "{{#each endpoints}}",
      "#[derive(Debug, thiserror::Error)]",
      "pub enum {{pascal_case name}}Error {",
      "{{#each errors}}",
      "    #[error(\"{{snake_case code}}\")]",
      "    {{pascal_case code}},",
      "{{/each}}",
      "    #[error(\"internal error: {0}\")]",
      "    Internal(#[from] anyhow::Error),",
      "}",
      "",
      "impl IntoResponse for {{pascal_case name}}Error {",
      "    fn into_response(self) -> axum::response::Response {",
      "        let status = match &self {",
      "{{#each errors}}",
      "            Self::{{pascal_case code}} => axum::http::StatusCode::from_u16({{status}}).unwrap_or(axum::http::StatusCode::INTERNAL_SERVER_ERROR),",
      "{{/each}}",
      "            Self::Internal(_) => axum::http::StatusCode::INTERNAL_SERVER_ERROR,",
      "        };",
      "        let body = serde_json::json!({ \"error\": self.to_string() });",
      "        (status, axum::Json(body)).into_response()",
      "    }",
      "}",
      "",
      "{{/each}}"
    ]
  }
}